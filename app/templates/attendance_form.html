{% extends "base.html" %} {% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h4 class="fw-bold mb-1">Input Absensi</h4>
    <span class="badge bg-dark">{{ today_date }} | {{ timeslot.name }}</span>
  </div>
  <a href="{{ url_for('main.dashboard') }}" class="btn btn-light rounded-circle"
    ><i class="fas fa-times"></i
  ></a>
</div>

<form method="POST" action="{{ url_for('attendance.submit') }}">
  <input type="hidden" name="program_name" value="Sesi Harian" />

  {% if bookings %}
  <div class="row g-3">
    {% for booking in bookings %}
    <div class="col-md-6 col-lg-4">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-body p-3">
          <div class="d-flex align-items-center mb-3">
            <div
              class="bg-soft-danger rounded-circle text-center me-3 fw-bold"
              style="width: 40px; height: 40px; line-height: 40px"
            >
              {{ booking.enrollment.student.name[0] }}
            </div>
            <div class="overflow-hidden">
              <h6 class="mb-0 fw-bold text-truncate">
                {{ booking.enrollment.student.name }}
              </h6>
              <small class="text-muted"
                >{{ booking.enrollment.program.name }}</small
              >
              <input
                type="hidden"
                name="booking_ids"
                value="{{ booking.id }}"
              />
            </div>
          </div>

          <div class="btn-group w-100 mb-3" role="group">
            <input
              type="radio"
              class="btn-check"
              name="status_{{ booking.id }}"
              id="h_{{ booking.id }}"
              value="Hadir"
              checked
            />
            <label class="btn btn-outline-success" for="h_{{ booking.id }}"
              >Hadir</label
            >

            <input
              type="radio"
              class="btn-check"
              name="status_{{ booking.id }}"
              id="i_{{ booking.id }}"
              value="Izin"
            />
            <label class="btn btn-outline-warning" for="i_{{ booking.id }}"
              >Izin</label
            >

            <input
              type="radio"
              class="btn-check"
              name="status_{{ booking.id }}"
              id="a_{{ booking.id }}"
              value="Alpha"
            />
            <label class="btn btn-outline-danger" for="a_{{ booking.id }}"
              >Alpha</label
            >
          </div>

          <input
            type="text"
            class="form-control bg-light border-0 form-control-sm"
            name="notes_{{ booking.id }}"
            placeholder="Catatan progress..."
          />
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <div
    class="fixed-bottom bg-white p-3 border-top shadow-lg"
    style="z-index: 1000"
  >
    <div class="container d-grid">
      <button
        type="submit"
        class="btn btn-danger py-2 fw-bold rounded-pill shadow"
      >
        Simpan Absensi & Kirim WA
      </button>
    </div>
  </div>
  <div style="height: 80px"></div>
  {% else %}
  <div class="text-center py-5">
    <div class="icon-box bg-light mx-auto mb-3 rounded-circle text-muted">
      <i class="fas fa-user-slash"></i>
    </div>
    <h5 class="fw-bold">Tidak ada jadwal</h5>
    <p class="text-muted">Tidak ada siswa yang mengambil sesi ini.</p>
    <a
      href="{{ url_for('main.dashboard') }}"
      class="btn btn-outline-dark rounded-pill mt-2"
      >Kembali</a
    >
  </div>
  {% endif %}
</form>
{% endblock %}
